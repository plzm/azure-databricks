{"version":"NotebookV1","origId":3551257439585118,"name":"adb_1_functions","language":"python","commands":[{"version":"CommandV1","origId":3551257439585119,"guid":"573034f3-cea7-44cd-8c89-2a56387ad933","subtype":"command","commandType":"auto","position":1.0,"command":"# Get iterable file list. Flattens hierarchical folder/file structure.\ndef GetFilesRecursive(rootPath):\n  final_list = []\n\n  for directoryItem in dbutils.fs.ls(rootPath):\n    directoryItemPathClean = directoryItem.path.replace(\"%25\", \"%\").replace(\"%25\", \"%\")\n    \n    if directoryItem.isDir() == True:\n      final_list = final_list + GetFilesRecursive(directoryItemPathClean)\n    else:\n      final_list.append(directoryItemPathClean)\n  \n  return final_list;","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543423066454,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d1300213-96a2-464a-8463-627257f15961"},{"version":"CommandV1","origId":3551257439585123,"guid":"ac0ca965-3f7b-4fce-b562-20eb1720fffd","subtype":"command","commandType":"auto","position":4.0,"command":"# Delete Spark job residual files (_SUCCESS, _start*, _committed*) down the folder/file hierarchy\n\nimport os\n\ndef CleanupSparkJobFiles(parquetFolderPath):\n  file_paths = GetFilesRecursive(parquetFolderPath)\n  \n  for file_path in file_paths:\n    # Get just the file name\n    file_name = os.path.basename(file_path)\n    # print(file_name)\n    \n    if file_name.startswith(\"_\"):\n      # Temp job file - delete it\n      dbutils.fs.rm(file_path)\n    # elif file_name.endswith(\".parquet\"):\n      # Data file - no op\n    # else:\n      # Something else - no op\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543424050724,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"210c9ea2-c4f7-4e70-860c-1873b77c7ad7"}],"dashboards":[],"guid":"99fe6dc4-c150-4931-8f6a-c7794bed8afc","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}