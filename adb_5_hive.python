{"version":"NotebookV1","origId":3551257439585227,"name":"adb_5_hive","language":"python","commands":[{"version":"CommandV1","origId":3551257439585237,"guid":"fbe8004e-4b5e-4830-882a-d86573495ee2","subtype":"command","commandType":"auto","position":3.0,"command":"display(spark.catalog.listDatabases())","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444262982,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f7b666a6-f592-4409-a4bb-066d01de800c"},{"version":"CommandV1","origId":3551257439585238,"guid":"2d71e532-7cf4-418f-962b-df1c55039fe9","subtype":"command","commandType":"auto","position":4.0,"command":"spark.sql(\"DROP DATABASE IF EXISTS \" + db_name + \" CASCADE\")","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444495569,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a0f45dba-2ae1-4333-8650-75891b387e71"},{"version":"CommandV1","origId":3551257439585239,"guid":"21bab528-5076-4725-86b0-6eedb14d43c2","subtype":"command","commandType":"auto","position":3.5,"command":"db_name = \"hackdb\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444492045,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a31ad8d3-e034-472d-816d-ed8fa1194ca0"},{"version":"CommandV1","origId":3551257439585240,"guid":"c5e92549-1ecc-4da1-887d-036a2044d2e5","subtype":"command","commandType":"auto","position":5.5,"command":"spark.catalog.setCurrentDatabase(db_name)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444498558,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a940e248-a3ac-402a-8833-f3237ad93092"},{"version":"CommandV1","origId":3551257439585241,"guid":"fb063993-13c2-4ae2-9e00-838a53e5600a","subtype":"command","commandType":"auto","position":5.75,"command":"# If this is run without specifying a db name, it will use the current database set above\n\nspark.catalog.listTables(db_name)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445563868,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3e74b9e8-ef67-4704-b93e-a9dd057b8949"},{"version":"CommandV1","origId":3551257439585243,"guid":"9be17bee-7357-4ceb-932a-37c1f1837d51","subtype":"command","commandType":"auto","position":5.0,"command":"spark.sql(\"CREATE DATABASE IF NOT EXISTS \" + db_name)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444496821,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"07076cd7-1ca2-4020-8856-3715d4c89071"},{"version":"CommandV1","origId":3551257439585244,"guid":"c2d17d92-4f4b-4cb0-af52-64568ac2cab1","subtype":"command","commandType":"auto","position":6.0,"command":"spark.sql(\"DROP TABLE IF EXISTS \" + table_name_airports)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445248070,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"59bfa04d-e58e-4e8e-845e-78f56d91bfbd"},{"version":"CommandV1","origId":3551257439585245,"guid":"5f67d4f1-2974-4adb-a1a9-d51013d6fc08","subtype":"command","commandType":"auto","position":2.5,"command":"%md\n#### Prepare database","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b43b35f2-2322-4687-bf70-b381a8b59d9c"},{"version":"CommandV1","origId":3551257439585246,"guid":"63d6794e-775b-413b-84c4-4860a4a92398","subtype":"command","commandType":"auto","position":5.625,"command":"%md\n#### Create external table on Parquet files, then query it","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ccf854c3-62ff-4b16-abab-9250fe664e78"},{"version":"CommandV1","origId":3551257439585247,"guid":"667ae961-dff6-4c7e-ad45-56121b9ba1cf","subtype":"command","commandType":"auto","position":5.6875,"command":"table_name_airports = \"airports\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543444856550,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ddbe5a14-3cfb-438b-bfe7-95a96953b37b"},{"version":"CommandV1","origId":3551257439585248,"guid":"e92bb317-5097-43fd-be8f-788695cef793","subtype":"command","commandType":"auto","position":7.0,"command":"spark.sql(\"\"\"\nCREATE TABLE IF NOT EXISTS \"\"\" + table_name_airports + \"\"\" (\nairport_id INT,\ncity STRING,\nstate STRING,\nname STRING)\nUSING parquet\nLOCATION '\"\"\" + parquet_path_airports + \"\"\"'\"\"\"\n)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445263548,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"376289f5-a496-4c44-abc8-065d213f06a6"},{"version":"CommandV1","origId":3551257439585250,"guid":"bf9c417d-f009-4224-9347-814adef7de8f","subtype":"command","commandType":"auto","position":9.0,"command":"display(spark.sql(\"SELECT * FROM \" + table_name_airports))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445271977,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5a34b0b9-2e3a-4915-9713-9671880cd7df"},{"version":"CommandV1","origId":3551257439585251,"guid":"dcc2cc93-8014-4ccb-91b5-ea953a5ebe0c","subtype":"command","commandType":"auto","position":5.875,"command":"display(sqlContext.tables())","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445267593,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0e6d5d39-d19e-4684-bddd-b2e63f864e26"},{"version":"CommandV1","origId":3551257439585252,"guid":"5b582903-4195-4095-8723-1b1d8a50bf2a","subtype":"command","commandType":"auto","position":10.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88b1c857-5d3a-4569-8521-b8219e777e35"},{"version":"CommandV1","origId":3551257439585253,"guid":"6a490273-1c20-4182-a61f-7407c89650d7","subtype":"command","commandType":"auto","position":5.71875,"command":"parquet_path_airports = \"/mnt/hack/parquet/sample/dat202/airports/\"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445259559,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a840b0f2-c394-48ef-a52e-bab598fd3fb3"},{"version":"CommandV1","origId":3551257439585255,"guid":"f365ad08-e45f-47b4-b9da-d4e43d5cb228","subtype":"command","commandType":"auto","position":8.0,"command":"# Alternative to spark.catalog.listTables()\n\ndisplay(spark.sql(\"SHOW TABLES\"))","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543445610675,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"paelaz@microsoft.com","latestUserId":"2080694937739106","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"59d02c28-7593-4ba3-ae6e-252c70b07f07"}],"dashboards":[],"guid":"c22a6b76-f16e-4812-bcbf-f01f1a8ec534","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}